# solace-logging-config

This is a collection of logging configuration files for use with Solace messaging routers.  Currently includes:

- rsyslog rules
- syslog-ng rules
- logstash grok rules (ELK / ElasticSearch)
- logrotate configuration
- crontab logrotate example
- (coming soon) SEC (Simple Event Correlator) log correlation rules

 
_These are very much WIP, and meant to give a Solace administrator a head-start on configuration._ The logstash grok rules are still really rough, but the rsyslog and syslog-ng rules are fairly complete.

They do basically the same thing:

- Listen on 3 different inbound TCP ports, one for dev, test, and prod (e.g. 51400, 51401, 51402 respectively)
  - This way I could add additional rules/processing later on depending on what port it is
  - This assumes a particular Solace router is designated as prod, test, or dev.  Maybe change to prod/non-prod?
- Ability to process all 3 log facilities arriving from Solace, but does some filtering.  For each router, it creates a directory
for it prefixed by `router.`.  Then inside each:
  - `system.log`: this is essentially left alone, but I think this log is dumb as it's a subset of `event.log`
  - `command.log`: all the commands, but filtering out all the 'show' commands 
(which can be exported to command via the CLI command `en --> con --> logging command all mode all`.
Very useful for watching SEMP monitoring polling rate.
  - `show.log`: all of the show commands get put into a separate file to not junk up the `command.log`
  - `event.log`: all of the router's event logs, minus a couple AUTH logs that are constantly generated by SEMP monitoring apps
  - `auth.log`: the events corresponding to CLI/SEMP logins/lougouts
  - For VPN and CLIENT events, parse out the VPN name... this allows me to create per-VPN directories
  (prefixed with `vpn.`), and keep an event log only for that VPN.  This is very useful if other VPNs on the same appliance
  are very noisy and cause the main event log to roll quickly.
- Then I monitor the event logs for events of interest that are duplicated to a general `alerts.log` file.  This file would ideally 
be watched by a monitoring program, rather than having the monitoring program trying to watch every router's complete event log.

I've also included an example logrotate configuration file, and a crontab entry to check every 2 minutes if the logs need rotating.

## Directory contents

This is what a particular router's directory would look like:

```
[alee@sg-sol-3501-host router.sg-sol-3501-vmr]$ ls -lh
total 15M
-rw-r--r--. 1 root root  77K Apr 19 01:50 auth.log
-rw-r--r--. 1 root root 9.7M Apr 19 00:55 command.log
-rw-r--r--. 1 root root 3.1M Apr 19 01:50 event.log
-rw-r--r--. 1 root root  79K Apr 19 01:51 show.log
-rw-r--r--. 1 root root 1.1M Apr 19 01:48 show.log.1
-rw-r--r--. 1 root root 2.2K Apr 19 01:06 show.log.2.gz
-rw-r--r--. 1 root root 2.2K Apr 19 01:04 show.log.3.gz
-rw-r--r--. 1 root root  22K Apr 19 00:55 system.log
drwxr-xr-x. 2 root root   23 Apr 18 19:47 vpn.bw
drwxr-xr-x. 2 root root   23 Apr 18 19:47 vpn.default
drwxr-xr-x. 2 root root   23 Apr 19 00:46 vpn.rest
[alee@sg-sol-3501-host router.sg-sol-3501-vmr]$
```
